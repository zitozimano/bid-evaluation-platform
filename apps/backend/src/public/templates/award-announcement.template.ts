export interface AwardAnnouncementDto {
  tenderNumber: string;
  description: string;
  category: string | null;
  createdAt: string | Date;
  winner: {
    bidderId: string;
    bidderName: string;
    totalScore: number;
  } | null;
  results: {
    bidderId: string;
    bidderName: string;
    totalScore: number;
    qualifies: boolean;
  }[];
}

export function renderAwardAnnouncementHtml(data: AwardAnnouncementDto): string {
  const rows = data.results
    .map(
      (r) => `
      <tr>
        <td>${r.bidderName}</td>
        <td>${r.totalScore}</td>
        <td>${r.qualifies ? "Yes" : "No"}</td>
      </tr>
    `,
    )
    .join("");

  return `
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Tender Award Announcement</title>
  <style>
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 12px; color: #111827; }
    h1 { font-size: 20px; text-align: center; margin-bottom: 8px; }
    h2 { font-size: 14px; margin-top: 16px; margin-bottom: 4px; }
    .section { margin-bottom: 16px; }
    table { width: 100%; border-collapse: collapse; margin-top: 8px; }
    th, td { border: 1px solid #e5e7eb; padding: 4px 6px; font-size: 11px; }
    th { background-color: #f3f4f6; text-align: left; }
    .meta { font-size: 11px; color: #6b7280; margin-top: 4px; }
  </style>
</head>
<body>
  <h1>Tender Award Announcement</h1>
  <div class="meta">
    Tender: ${data.tenderNumber} • Category: ${data.category ?? "-"} • Date:
    ${new Date(data.createdAt).toLocaleDateString()}
  </div>

  <div class="section">
    <h2>Tender Details</h2>
    <p>${data.description}</p>
  </div>

  ${
    data.winner
      ? `
  <div class="section">
    <h2>Awarded Bidder</h2>
    <p><strong>${data.winner.bidderName}</strong> (${data.winner.bidderId}) – Score: ${data.winner.totalScore}</p>
  </div>
  `
      : ""
  }

  <div class="section">
    <h2>Bidder Scores</h2>
    <table>
      <thead>
        <tr>
          <th>Bidder</th>
          <th>Total Score</th>
          <th>Qualifies</th>
        </tr>
      </thead>
      <tbody>
        ${rows}
      </tbody>
    </table>
  </div>

  <div class="section">
    <p class="meta">Generated by Bid Evaluation Platform</p>
  </div>
</body>
</html>
`;
}
